#!/usr/bin/env python3
import string
from Crypto.Hash import SHA256

enc_flag = "04ded642e70268452fd1413837bd19554782fe458a4b778c07ffa3d83cf20758"

def sha(input:str):
    sha = SHA256.new()
    sha.update(input.encode())
    outputBuffer = sha.hexdigest()
    #print(outputBuffer)
    return outputBuffer

def decrypt(enc_flag):
    for a1 in string.printable:
        if a1 != 'e':
            continue
        for a2 in string.printable:
            for a3 in string.printable:
                for a4 in string.printable:
                    flag = "flag{" + a1 + a2 + a3 + a4 + "}"
                    hflag = sha(flag)
                    print(f"Trying {flag}")
                    if hflag == enc_flag:
                        print(f"Flag found: {flag}")
                        return
    print("Flag not found")

decrypt(enc_flag)
#flag = "flag{e42#}"
#print(flag_generator(flag))
print(enc_flag)

